<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…ØªØ¬Ø± ÙƒÙˆÙŠÙ†Ø²</title>
  <style>
    body {font-family: Arial, sans-serif; margin:0; padding:0; background:#f9f9f9; direction:rtl;}
    header {background:#007bff; color:#fff; padding:15px; text-align:center; font-size:20px;}
    .products {display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; padding:20px;}
    .card {background:#fff; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); padding:15px; text-align:center;}
    .card img {max-width:100%; border-radius:10px;}
    .price {margin:10px 0; font-weight:bold; color:#333;}
    .btn {background:#007bff; color:#fff; border:none; padding:10px 15px; border-radius:8px; cursor:pointer;}
    .btn:hover {background:#0056b3;}
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ù„Ø¨ */
    .popup {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:1000;}
    .popup-content {background:#fff; padding:20px; border-radius:15px; width:90%; max-width:400px; text-align:center; position:relative;}
    .close {position:absolute; top:10px; left:10px; cursor:pointer; font-size:20px;}
    .qr-img {width:200px; margin:10px auto; display:block;}
    /* âœ… Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ Ø§Ù„ÙˆØ³Ø· */
    .popup-content input {
      display:block;
      width:80%;
      max-width: 280px;
      font-size: 14px;
      padding: 8px;
      margin: 8px auto;
      border:1px solid #ccc;
      border-radius:8px;
      text-align:center;
    }
    .row {display:flex; justify-content:center; gap:5px; flex-wrap:wrap;}
    .row input {width:45%;}
    .popup-content h3 {font-size:16px;}
    .popup-content button {font-size:14px; padding:8px 12px;}
    /* Ø³Ù„Ø© Ø¹Ø§Ø¦Ù…Ø© (ÙŠØ³Ø§Ø± Ø£Ø¹Ù„Ù‰) */
    .cart-btn {
      position:fixed;
      top:70px;
      left:20px;
      background:#222;
      color:#fff;
      padding:10px 15px;
      border-radius:30px;
      box-shadow:0 4px 10px rgba(0,0,0,0.3);
      cursor:pointer;
      z-index:1100;
    }
    .checkmark {display:none; font-size:48px; color:green; animation:pop 0.5s ease;}
    @keyframes pop {0%{transform:scale(0);}100%{transform:scale(1);}}
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ù„Ø© */
    #ordersListPopup {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:2000;}
    #ordersListPopup .popup-content {background:#fff; padding:20px; border-radius:15px; width:90%; max-width:600px; text-align:right; max-height:80vh; overflow-y:auto; position:relative;}
    #ordersListPopup .close {position:absolute; top:10px; left:10px; cursor:pointer; font-size:22px; color:#333;}
    .order-card {background:#fdfdfd; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:12px; margin-bottom:10px;}
    .order-card strong {color:#007bff;}
    .order-card p {margin:4px 0; font-size:14px;}
    /* Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width:600px) {
      header {font-size:18px; padding:12px;}
      .products {grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); padding:10px;}
      .card {padding:10px;}
      .btn {padding:8px 12px; font-size:14px;}
      input {width:100%;}
      .row {flex-direction:column;}
      .row input {width:100%;}
      .popup-content {width:95%; padding:15px;}
      .qr-img {width:150px;}
    }
  </style>
</head>
<body>
<header>ğŸ›’ Ù…ØªØ¬Ø± Ø§Ù„ÙƒÙˆÙŠÙ†Ø²</header>

<div class="products" id="products"></div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ù„Ø¨ -->
<div class="popup" id="orderPopup">
  <div class="popup-content">
    <span class="close" onclick="closeOrderPopup()">&times;</span>
    <h3 id="popupTitle"></h3>
    <div id="stepContent"></div>
    <div class="checkmark" id="checkmark">âœ”ï¸</div>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
<div class="popup" id="ordersListPopup">
  <div class="popup-content">
    <span class="close" onclick="closeOrdersPopup()">&times;</span>
    <h3>ğŸ›ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
    <div id="ordersList"></div>
  </div>
</div>

<!-- Ø²Ø± Ø§Ù„Ø³Ù„Ø© -->
<div class="cart-btn" onclick="showOrdersPopup()">ğŸ›ï¸ <span id="cartCount">0</span></div>

<script>
/* âœ… Ù…Ù†ØªØ¬Ø§Øª ÙƒØ«ÙŠØ±Ø© Ø¨Ø£Ø³Ø¹Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© */
const productsData = [
  {id:1, title:"Ø¬ÙˆØ§ÙƒØ±", price:1.2, img:"https://via.placeholder.com/200"},
  {id:2, title:"Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ", price:2.5, img:"https://via.placeholder.com/200"},
  {id:3, title:"Ø¬ÙˆØ§Ù‡Ø± ÙØ±ÙŠ ÙØ§ÙŠØ±", price:3.1, img:"https://via.placeholder.com/200"},
  {id:4, title:"ÙÙˆØ±Øª Ù†Ø§ÙŠØª V-Bucks", price:4.5, img:"https://via.placeholder.com/200"},
  {id:5, title:"ÙƒØ±ÙŠØ¯Øª Ù…Ø§ÙŠÙ†ÙƒØ±Ø§ÙØª", price:2.0, img:"https://via.placeholder.com/200"},
  {id:6, title:"Ø´Ø­Ù† Ø±ÙˆØ¨Ù„ÙˆÙƒØ³", price:3.9, img:"https://via.placeholder.com/200"},
  {id:7, title:"ÙƒÙˆÙ„ Ø£ÙˆÙ Ø¯ÙŠÙˆØªÙŠ CP", price:4.2, img:"https://via.placeholder.com/200"},
  {id:8, title:"ÙƒØ§Ø´ Ø£Ø¨ Ø³ØªÙˆØ±", price:5.5, img:"https://via.placeholder.com/200"},
  {id:9, title:"ÙƒØ§Ø´ Ø¬ÙˆØ¬Ù„ Ø¨Ù„Ø§ÙŠ", price:6.0, img:"https://via.placeholder.com/200"},
  {id:10, title:"Ø¨Ø·Ø§Ù‚Ø© Ù†ØªÙÙ„ÙƒØ³", price:7.2, img:"https://via.placeholder.com/200"},
  {id:11, title:"Ø¨Ø·Ø§Ù‚Ø© Ø³Ø¨ÙˆØªÙŠÙØ§ÙŠ", price:3.4, img:"https://via.placeholder.com/200"},
  {id:12, title:"Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù„Ø§ÙŠØ³ØªÙŠØ´Ù†", price:8.9, img:"https://via.placeholder.com/200"},
  {id:13, title:"Ø¨Ø·Ø§Ù‚Ø© Ø§ÙƒØ³ Ø¨ÙˆÙƒØ³", price:9.3, img:"https://via.placeholder.com/200"},
  {id:14, title:"Ø¬ÙŠÙ… Ø¨Ø§Ø³ PC", price:4.7, img:"https://via.placeholder.com/200"},
  {id:15, title:"Ø¨Ø·Ø§Ù‚Ø© Ø³ØªÙŠÙ…", price:5.6, img:"https://via.placeholder.com/200"}
];
let currentProduct=null, currentStep=1, customerName="", customerID="", customerWhatsApp="", coinAmount=0, coinPrice=0;
let sentOrders = JSON.parse(localStorage.getItem('sentOrders')||'[]');
const ownerWhatsApp = "+20123456789";
const ownerEmail = "owner@example.com";

function renderProducts(){
  const productsEl=document.getElementById('products');
  productsEl.innerHTML="";
  productsData.forEach(p=>{
    const card=document.createElement('div');
    card.className="card";
    card.innerHTML=`<img src="${p.img}" alt="${p.title}" />
      <h4>${p.title}</h4>
      <div class="price">${p.price.toFixed(2)} USD</div>
      <button class="btn" onclick="startOrder(${p.id})">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>`;
    productsEl.appendChild(card);
  });
}

function startOrder(productId){
  currentProduct=productsData.find(p=>p.id===productId);
  currentStep=1; customerName=""; customerID=""; customerWhatsApp="";
  coinAmount=0; coinPrice=0;
  document.getElementById('checkmark').style.display="none";
  document.getElementById('stepContent').style.display="block";
  showStep();
  document.getElementById('orderPopup').style.display="flex";
}
function closeOrderPopup(){document.getElementById('orderPopup').style.display="none";}

function showStep(){
  const title=document.getElementById('popupTitle');
  const content=document.getElementById('stepContent');
  if(currentStep===1){
    title.textContent=`Ø·Ù„Ø¨: ${currentProduct.title}`;
    content.innerHTML=`<div class="row">
        <input id="coinAmount" type="number" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²" oninput="calcPrice()" />
        <input id="coinPrice" placeholder="Ø§Ù„Ø³Ø¹Ø± (USD)" readonly />
      </div>
      <button class="btn" onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ</button>`;
  } else if(currentStep===2){
    title.textContent=`Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨`;
    content.innerHTML=`<input id="customerName" placeholder="Ø§Ø³Ù…Ùƒ / Ø­Ø³Ø§Ø¨Ùƒ" />
      <input id="customerID" placeholder="ID Ø§Ù„Ø­Ø³Ø§Ø¨" />
      <input id="customerWhatsApp" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªÙˆØ§ØµÙ„" />
      <button class="btn" onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ</button>`;
  } else if(currentStep===3){
    title.textContent=`Ø§Ù„Ø¯ÙØ¹`;
    content.innerHTML=`<p>Ø§Ù…Ø³Ø­ Ø§Ù„Ø´ÙŠÙØ±Ø© Ù„Ù„Ø¯ÙØ¹</p>
      <img class="qr-img" src="https://c.top4top.io/p_3512ytqp71.jpg" alt="Ø´ÙŠÙØ±Ø© Ø§Ù„Ø¯ÙØ¹" />
      <button class="btn" onclick="paymentDone()">ØªÙ… Ø§Ù„Ø¯ÙØ¹</button>`;
  }
}
function calcPrice(){
  const amount=parseInt(document.getElementById('coinAmount').value)||0;
  coinAmount=amount;
  const base=currentProduct.price;
  coinPrice=((amount/1000)* (base+0.3)).toFixed(2);
  document.getElementById('coinPrice').value=coinPrice+" USD";
}
function nextStep(){
  if(currentStep===1){
    if(!coinAmount || coinAmount<=0){alert("Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²"); return;}
    currentStep++;
  } else if(currentStep===2){
    const name=document.getElementById('customerName').value.trim();
    const id=document.getElementById('customerID').value.trim();
    const wa=document.getElementById('customerWhatsApp').value.trim();
    if(!name||!id||!wa){alert("Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return;}
    customerName=name; customerID=id; customerWhatsApp=wa;
    currentStep++;
  }
  showStep();
}
function paymentDone(){
  document.getElementById('checkmark').style.display="flex";
  document.getElementById('stepContent').style.display="none";
  setTimeout(()=>{
    sendOrder();
    document.getElementById('stepContent').style.display="block";
    document.getElementById('checkmark').style.display="none";
  },2000);
}
function sendOrder(){
  const formattedText=`ğŸ›ï¸ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯* ğŸ›ï¸
ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${currentProduct.title}
ğŸ’° Ø§Ù„ÙƒÙˆÙŠÙ†Ø²: ${coinAmount}
ğŸ’µ Ø§Ù„Ø³Ø¹Ø±: ${coinPrice} USD
ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${customerName}
ğŸ†” ID: ${customerID}
ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customerWhatsApp}`;

  if(/Android|iPhone|iPad/i.test(navigator.userAgent)){
    window.location.href=`https://wa.me/${ownerWhatsApp.replace('+','')}?text=${encodeURIComponent(formattedText)}`;
  } else {
    window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(ownerEmail)}&su=${encodeURIComponent('Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯')}&body=${encodeURIComponent(formattedText)}`,'_blank');
  }
  const order={product:currentProduct.title, coins:coinAmount, price:coinPrice, name:customerName, id:customerID, whatsapp:customerWhatsApp};
  sentOrders.push(order);
  localStorage.setItem('sentOrders',JSON.stringify(sentOrders));
  updateCartCount();
  closeOrderPopup();
}
function updateCartCount(){document.getElementById('cartCount').textContent=sentOrders.length;}
function showOrdersPopup(){
  const ordersPopup=document.getElementById('ordersListPopup');
  const ordersList=document.getElementById('ordersList');
  if(sentOrders.length===0){ordersList.innerHTML='<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>';}
  else {
    ordersList.innerHTML=sentOrders.map((o,i)=>`
      <div class="order-card">
        <strong>Ø·Ù„Ø¨ #${i+1}</strong>
        <p>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${o.product}</p>
        <p>ğŸ’° Ø§Ù„ÙƒÙˆÙŠÙ†Ø²: ${o.coins}</p>
        <p>ğŸ’µ Ø§Ù„Ø³Ø¹Ø±: ${o.price} USD</p>
        <p>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${o.name}</p>
        <p>ğŸ†” ID: ${o.id}</p>
        <p>ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨: ${o.whatsapp}</p>
      </div>`).join('');
  }
  ordersPopup.style.display='flex';
}
function closeOrdersPopup(){document.getElementById('ordersListPopup').style.display='none';}

window.onload=()=>{renderProducts(); updateCartCount();};
</script>
</body>
</html>
